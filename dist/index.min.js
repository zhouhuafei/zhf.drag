"use strict";var _createClass=function(){function e(e,o){for(var i=0;i<o.length;i++){var t=o[i];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}return function(o,i,t){return i&&e(o.prototype,i),t&&e(o,t),o}}();function _classCallCheck(e,o){if(!(e instanceof o))throw new TypeError("Cannot call a class as a function")}var extend=require("zhf.extend"),getDomArray=require("zhf.get-dom-array"),Super=function(){function e(o){var i=this;_classCallCheck(this,e),this.opts=extend({item:"",callback:{mouseDownBefore:function(){},mouseDownAfter:function(){},mouseMoveBefore:function(){},mouseMoveAfter:function(){},mouseUpBefore:function(){},mouseUpAfter:function(){}},config:{hasIconMove:!0,direction:"all",limitLeftMin:null,limitLeftMax:null,limitTopMin:null,limitTopMax:null,isAdsorption:!1,adsorptionDistance:20},data:{}},o),getDomArray(this.opts.item).forEach(function(e){i.events(e)})}return _createClass(e,[{key:"events",value:function(e){var o=this,i=o.opts.config;function t(e){e.preventDefault(),e.stopPropagation();var i=o.opts,t=i.callback;t.mouseMoveBefore({self:o,ev:e,dom:o.item,moveSpeedX:o.moveSpeedX,moveSpeedY:o.moveSpeedY,moveDirectionX:o.moveDirectionX,moveDirectionY:o.moveDirectionY,overDirectionX:o.overDirectionX,overDirectionY:o.overDirectionY});var n=i.config,r=n.direction,m=e.clientX-o.disX,v=e.clientY-o.disY;null!==n.limitLeftMin&&(n.isAdsorption?m<=n.limitLeftMin+n.adsorptionDistance&&(m=n.limitLeftMin):m<=n.limitLeftMin&&(m=n.limitLeftMin)),null!==n.limitLeftMax&&(n.isAdsorption?m>=n.limitLeftMax-n.adsorptionDistance&&(m=n.limitLeftMax):m>=n.limitLeftMax&&(m=n.limitLeftMax)),null!==n.limitTopMin&&(n.isAdsorption?v<=n.limitTopMin+n.adsorptionDistance&&(v=n.limitTopMin):v<=n.limitTopMin&&(v=n.limitTopMin)),null!==n.limitTopMax&&(n.isAdsorption?v>=n.limitTopMax-n.adsorptionDistance&&(v=n.limitTopMax):v>=n.limitTopMax&&(v=n.limitTopMax)),o.item.style.right="auto",o.item.style.bottom="auto","all"===r&&(o.item.style.left=m+"px",o.item.style.top=v+"px"),"col"===r&&(o.item.style.top=v+"px"),"row"===r&&(o.item.style.left=m+"px"),o.moveSpeedX=e.clientX-o.prevMoveClientX,o.moveSpeedY=e.clientY-o.prevMoveClientY,o.moveSpeedX>0?o.moveDirectionX="right":o.moveSpeedX<0&&(o.moveDirectionX="left"),o.moveSpeedY>0?o.moveDirectionY="bottom":o.moveSpeedY<0&&(o.moveDirectionY="top"),o.prevMoveClientX=e.clientX,o.prevMoveClientY=e.clientY;var c=e.clientX-o.mouseDownClientX,l=e.clientY-o.mouseDownClientY;c>0?o.overDirectionX="right":c<0&&(o.overDirectionX="left"),l>0?o.overDirectionY="bottom":l<0&&(o.overDirectionY="top"),t.mouseMoveAfter({self:o,ev:e,dom:o.item,moveSpeedX:o.moveSpeedX,moveSpeedY:o.moveSpeedY,moveDirectionX:o.moveDirectionX,moveDirectionY:o.moveDirectionY,overDirectionX:o.overDirectionX,overDirectionY:o.overDirectionY})}function n(e){e.preventDefault(),e.stopPropagation();var i=o.opts.callback;i.mouseUpBefore({self:o,ev:e,dom:o.item,moveSpeedX:o.moveSpeedX,moveSpeedY:o.moveSpeedY,moveDirectionX:o.moveDirectionX,moveDirectionY:o.moveDirectionY,overDirectionX:o.overDirectionX,overDirectionY:o.overDirectionY}),document.removeEventListener("mousemove",t),document.removeEventListener("mouseup",n),i.mouseUpAfter({self:o,ev:e,dom:o.item,moveSpeedX:o.moveSpeedX,moveSpeedY:o.moveSpeedY,moveDirectionX:o.moveDirectionX,moveDirectionY:o.moveDirectionY,overDirectionX:o.overDirectionX,overDirectionY:o.overDirectionY})}"static"===getComputedStyle(e).position&&(e.style.position="relative"),i.hasIconMove&&"move"!==getComputedStyle(e).cursor&&(e.style.cursor="move"),e.addEventListener("mousedown",function(e){e.preventDefault(),e.stopPropagation();var i=o.opts;o.item=this,o.moveSpeedX=0,o.moveSpeedY=0,o.moveDirectionX="no-move",o.moveDirectionY="no-move",o.overDirectionX="no-move",o.overDirectionY="no-move",o.prevMoveClientX=e.clientX,o.prevMoveClientY=e.clientY,o.mouseDownClientX=e.clientX,o.mouseDownClientY=e.clientY;var r=i.callback;r.mouseDownBefore({self:o,ev:e,dom:o.item,moveSpeedX:o.moveSpeedX,moveSpeedY:o.moveSpeedY,moveDirectionX:o.moveDirectionX,moveDirectionY:o.moveDirectionY,overDirectionX:o.overDirectionX,overDirectionY:o.overDirectionY});var m=getComputedStyle(this);o.oGetComputedStyle=m,o.disX=e.clientX-m.left.replace("px",""),o.disY=e.clientY-m.top.replace("px",""),document.addEventListener("mousemove",t),document.addEventListener("mouseup",n),r.mouseDownAfter({self:o,ev:e,dom:o.item,moveSpeedX:o.moveSpeedX,moveSpeedY:o.moveSpeedY,moveDirectionX:o.moveDirectionX,moveDirectionY:o.moveDirectionY,overDirectionX:o.overDirectionX,overDirectionY:o.overDirectionY})})}}]),e}();module.exports=Super;