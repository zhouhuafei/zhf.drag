"use strict";var _createClass=function(){function e(e,o){for(var t=0;t<o.length;t++){var i=o[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(o,t,i){return t&&e(o.prototype,t),i&&e(o,i),o}}();function _classCallCheck(e,o){if(!(e instanceof o))throw new TypeError("Cannot call a class as a function")}var extend=require("zhf.extend"),getDomArray=require("zhf.get-dom-array"),Super=function(){function e(o){var t=this;_classCallCheck(this,e),this.opts=extend({item:"",controlledWrap:null,callback:{mouseDownBefore:function(e){},mouseDownAfter:function(e){},mouseMoveBefore:function(e){},mouseMoveAfter:function(e){},mouseUpBefore:function(e){},mouseUpAfter:function(e){}},config:{hasIconMove:!0,direction:"all",limitLeftMin:null,limitLeftMax:null,limitTopMin:null,limitTopMax:null,isAdsorption:!1,adsorptionDistance:20},data:{}},o),getDomArray(this.opts.item).forEach(function(e){t.events(e)})}return _createClass(e,[{key:"events",value:function(e){var o=this,t=o.opts,i=t.config,n=document.createElement("span");n.setAttribute("style","position: absolute;width: 100%;height: 100%;z-index: 9999;left: 0;top: 0;"),e.appendChild(n),"static"===getComputedStyle(e).position&&(e.style.position="relative"),i.hasIconMove&&"move"!==getComputedStyle(e).cursor&&(e.style.cursor="move");var r=getDomArray(t.controlledWrap)[0];function c(t){t.preventDefault(),t.stopPropagation();var i=o.opts,n=i.callback;n.mouseMoveBefore({self:o,ev:t,dom:e,controlledWrapDom:r,moveDistanceX:o.moveDistanceX,moveDistanceY:o.moveDistanceY,moveDirectionX:o.moveDirectionX,moveDirectionY:o.moveDirectionY,overDistanceX:o.overDistanceX,overDistanceY:o.overDistanceY,overDirectionX:o.overDirectionX,overDirectionY:o.overDirectionY});var c=i.config,v=c.direction,s=t.clientX-o.disX,a=t.clientY-o.disY;null!==c.limitLeftMin&&(c.isAdsorption?s<=c.limitLeftMin+c.adsorptionDistance&&(s=c.limitLeftMin):s<=c.limitLeftMin&&(s=c.limitLeftMin)),null!==c.limitLeftMax&&(c.isAdsorption?s>=c.limitLeftMax-c.adsorptionDistance&&(s=c.limitLeftMax):s>=c.limitLeftMax&&(s=c.limitLeftMax)),null!==c.limitTopMin&&(c.isAdsorption?a<=c.limitTopMin+c.adsorptionDistance&&(a=c.limitTopMin):a<=c.limitTopMin&&(a=c.limitTopMin)),null!==c.limitTopMax&&(c.isAdsorption?a>=c.limitTopMax-c.adsorptionDistance&&(a=c.limitTopMax):a>=c.limitTopMax&&(a=c.limitTopMax));var m=e;r&&(m=r),m.style.right="auto",m.style.bottom="auto","all"===v&&(m.style.left=s+"px",m.style.top=a+"px"),"col"===v&&(m.style.top=a+"px"),"row"===v&&(m.style.left=s+"px"),o.moveDistanceX=t.clientX-o.prevMoveClientX,o.moveDistanceY=t.clientY-o.prevMoveClientY,o.moveDistanceX>0?o.moveDirectionX="right":o.moveDistanceX<0&&(o.moveDirectionX="left"),o.moveDistanceY>0?o.moveDirectionY="bottom":o.moveDistanceY<0&&(o.moveDirectionY="top"),o.prevMoveClientX=t.clientX,o.prevMoveClientY=t.clientY,o.overDistanceX=t.clientX-o.mouseDownClientX,o.overDistanceY=t.clientY-o.mouseDownClientY,o.overDistanceX>0?o.overDirectionX="right":o.overDistanceX<0&&(o.overDirectionX="left"),o.overDistanceY>0?o.overDirectionY="bottom":o.overDistanceY<0&&(o.overDirectionY="top"),n.mouseMoveAfter({self:o,ev:t,dom:e,controlledWrapDom:r,moveDistanceX:o.moveDistanceX,moveDistanceY:o.moveDistanceY,moveDirectionX:o.moveDirectionX,moveDirectionY:o.moveDirectionY,overDistanceX:o.overDistanceX,overDistanceY:o.overDistanceY,overDirectionX:o.overDirectionX,overDirectionY:o.overDirectionY})}function v(t){t.preventDefault(),t.stopPropagation();var i=o.opts.callback;i.mouseUpBefore({self:o,ev:t,dom:e,controlledWrapDom:r,moveDistanceX:o.moveDistanceX,moveDistanceY:o.moveDistanceY,moveDirectionX:o.moveDirectionX,moveDirectionY:o.moveDirectionY,overDistanceX:o.overDistanceX,overDistanceY:o.overDistanceY,overDirectionX:o.overDirectionX,overDirectionY:o.overDirectionY}),document.removeEventListener("mousemove",c),document.removeEventListener("mouseup",v),i.mouseUpAfter({self:o,ev:t,dom:e,controlledWrapDom:r,moveDistanceX:o.moveDistanceX,moveDistanceY:o.moveDistanceY,moveDirectionX:o.moveDirectionX,moveDirectionY:o.moveDirectionY,overDistanceX:o.overDistanceX,overDistanceY:o.overDistanceY,overDirectionX:o.overDirectionX,overDirectionY:o.overDirectionY})}r&&"static"===getComputedStyle(r).position&&(r.style.position="relative"),o.dom=e,o.controlledWrapDom=r,e.addEventListener("mousedown",function(t){t.preventDefault(),t.stopPropagation();var i=o.opts;o.moveDistanceX=0,o.moveDistanceY=0,o.moveDirectionX="no-move",o.moveDirectionY="no-move",o.overDistanceX=0,o.overDistanceY=0,o.overDirectionX="no-move",o.overDirectionY="no-move",o.prevMoveClientX=t.clientX,o.prevMoveClientY=t.clientY,o.mouseDownClientX=t.clientX,o.mouseDownClientY=t.clientY;var n=i.callback;n.mouseDownBefore({self:o,ev:t,dom:e,controlledWrapDom:r,moveDistanceX:o.moveDistanceX,moveDistanceY:o.moveDistanceY,moveDirectionX:o.moveDirectionX,moveDirectionY:o.moveDirectionY,overDistanceX:o.overDistanceX,overDistanceY:o.overDistanceY,overDirectionX:o.overDirectionX,overDirectionY:o.overDirectionY});var s=getComputedStyle(e);r&&(s=getComputedStyle(r)),o.oGetComputedStyle=s,o.disX=t.clientX-s.left.replace("px",""),o.disY=t.clientY-s.top.replace("px",""),document.addEventListener("mousemove",c),document.addEventListener("mouseup",v),n.mouseDownAfter({self:o,ev:t,dom:e,controlledWrapDom:r,moveDistanceX:o.moveDistanceX,moveDistanceY:o.moveDistanceY,moveDirectionX:o.moveDirectionX,moveDirectionY:o.moveDirectionY,overDistanceX:o.overDistanceX,overDistanceY:o.overDistanceY,overDirectionX:o.overDirectionX,overDirectionY:o.overDirectionY})})}}]),e}();module.exports=Super;